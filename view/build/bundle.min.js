!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){n(1),t.exports=n(6)},function(t,e,n){var r=n(2);"string"==typeof r&&(r=[[t.i,r,""]]);n(4)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(t.exports=r.locals)},function(t,e,n){(t.exports=n(3)(!1)).push([t.i,"body{margin:0;padding:0;font-family:sans-serif}",""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r),a=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(a).concat([i]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(r[a]=!0)}for(i=0;i<t.length;i++){var o=t[i];"number"==typeof o[0]&&r[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(t,e,n){var r={},i=function(t){var e;return function(){return void 0===e&&(e=function(){return window&&document&&document.all&&!window.atob}.apply(this,arguments)),e}}(),a=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),o=null,u=0,c=[],s=n(5);function f(t,e){for(var n=0;n<t.length;n++){var i=t[n],a=r[i.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](i.parts[o]);for(;o<i.parts.length;o++)a.parts.push(v(i.parts[o],e))}else{var u=[];for(o=0;o<i.parts.length;o++)u.push(v(i.parts[o],e));r[i.id]={id:i.id,refs:1,parts:u}}}}function p(t,e){for(var n=[],r={},i=0;i<t.length;i++){var a=t[i],o=e.base?a[0]+e.base:a[0],u={css:a[1],media:a[2],sourceMap:a[3]};r[o]?r[o].parts.push(u):n.push(r[o]={id:o,parts:[u]})}return n}function l(t,e){var n=a(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=c[c.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),c.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=a(t.insertAt.before,n);n.insertBefore(e,i)}}function _(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function d(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=n.nc;r&&(t.attrs.nonce=r)}return m(e,t.attrs),l(t,e),e}function m(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function v(t,e){var n,r,i,a;if(e.transform&&t.css){if(!(a=e.transform(t.css)))return function(){};t.css=a}if(e.singleton){var c=u++;n=o||(o=d(e)),r=b.bind(null,n,c,!1),i=b.bind(null,n,c,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),l(t,e),e}(e),r=function(t,e,n){var r=n.css,i=n.sourceMap,a=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||a)&&(r=s(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([r],{type:"text/css"}),u=t.href;t.href=URL.createObjectURL(o),u&&URL.revokeObjectURL(u)}.bind(null,n,e),i=function(){_(n),n.href&&URL.revokeObjectURL(n.href)}):(n=d(e),r=function(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){_(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=i()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return f(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var o=n[a];(u=r[o.id]).refs--,i.push(u)}for(t&&f(p(t,e),e),a=0;a<i.length;a++){var u;if(0===(u=i[a]).refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete r[u.id]}}}};var h=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function b(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=h(e,i);else{var a=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,a=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:r+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e){(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(t,e){var n=function(t){return t&&"string"==typeof t};t.exports={isTruthyString:n,isStringArray:function(t){return Array.isArray(t)&&t.every(n)}}},106:function(t,e){var n={whoami:function(t,e){return{type:"WHOAMI",user:t,tx:e,unix_ts_ms:Date.now()}},register:function(t,e,n){return{type:"REGISTER",user:t,password:e,tx:n,unix_ts_ms:Date.now()}},login:function(t,e,n){return{type:"LOGIN",user:t,password:e,tx:n,unix_ts_ms:Date.now()}},logout:function(t,e){return{type:"LOGOUT",user:t,tx:e,unix_ts_ms:Date.now()}},addPeers:function(t,e,n){return{type:"ADD_PEERS",user:t,peers:e,tx:n,unix_ts_ms:Date.now()}},deletePeers:function(t,e,n){return{type:"DEL_PEERS",user:t,peers:e,tx:n,unix_ts_ms:Date.now()}},getPeers:function(t,e){return{type:"GET_PEERS",user:t,tx:e,unix_ts_ms:Date.now()}},getUser:function(t,e){return{type:"GET_USER",user:t,tx:e,unix_ts_ms:Date.now()}},status:function(t,e,n){return{type:"STATUS",user:t,status:e,tx:n,unix_ts_ms:Date.now()}},call:function(t,e,n){return{type:"CALL",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},accept:function(t,e,n){return{type:"ACCEPT",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},reject:function(t,e,n){return{type:"REJECT",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},unpair:function(t,e,n){return{type:"UNPAIR",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},info:function(t,e){return JSON.stringify({user:t,peer:e,unix_ts_ms:Date.now()})},avatar:function(t,e,n){return{type:"AVATAR",user:t,avatar:e,tx:n,unix_ts_ms:Date.now()}},stopRinging:function(t,e,n){return{type:"STOP_RINGING",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}}};t.exports=n},125:function(t,e,n){},127:function(t,e,n){"use strict";n.r(e);var r=n(31),i=n.n(r),a=n(0),o=n.n(a),u=n(10),c=n(1),s=n(52),f=n(53),p=n.n(f),l=n(3),_=n.n(l),d=n(6),m=function(t,e){return{type:"FRONTEND_CRASH",unix_ts_ms:Date.now(),err_name:t.name,err_message:t.message,err_stack:t.stack,err_fileName:t.fileName,err_lineNumber:t.lineNumber,err_columnNumber:t.columnNumber,state:e}},v=function(t){return{type:"USER",unix_ts_ms:Date.now(),user:t}},h=function(){return{type:"LOGIN",unix_ts_ms:Date.now()}},b=function(){return{type:"LOGOUT",unix_ts_ms:Date.now()}};function O(){return{type:"TOGGLE_PASSWORD_VISIBILITY",unix_ts_ms:Date.now()}}function g(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r){var i,a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=m(t,r()),n(i),a={method:"post",body:JSON.stringify(i)},e.prev=3,e.next=6,fetch("http://localhost:10000/crash",a);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(3);case 10:case"end":return e.stop()}},e,this,[[3,8]])}));return function(t,n){return e.apply(this,arguments)}}()}function y(t,e){return function(){var n=Object(d.a)(_.a.mark(function n(r,i,a){var o;return _.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=a.client,r(v(t)),o.setUser(t),n.prev=3,n.next=6,o.whoami();case 6:n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(3),n.abrupt("return",alert("identification failed"));case 11:return n.prev=11,n.next=14,o.register(e);case 14:n.next=19;break;case 16:return n.prev=16,n.t1=n.catch(11),n.abrupt("return",alert("registration failed"));case 19:r(T(t,e));case 20:case"end":return n.stop()}},n,this,[[3,8],[11,16]])}));return function(t,e,r){return n.apply(this,arguments)}}()}var w=function(){return{type:"RESET",unix_ts_ms:Date.now()}};function T(t,e){return function(){var n=Object(d.a)(_.a.mark(function n(r,i,a){var o,u;return _.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=a.client,t!==i().user&&r(v(t)),t!==o.user&&o.setUser(t),n.prev=3,n.next=6,o.whoami();case 6:n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(3),n.abrupt("return",alert("identification failed"));case 11:return n.prev=11,n.next=14,o.login(e);case 14:n.next=19;break;case 16:return n.prev=16,n.t1=n.catch(11),n.abrupt("return",alert("login failed"));case 19:return n.prev=19,n.next=22,o.getUser();case 22:u=n.sent,r(B(u.avatar)),r(L(u.status)),n.next=30;break;case 27:return n.prev=27,n.t2=n.catch(19),n.abrupt("return",alert("fetching user data failed"));case 30:return n.prev=30,n.t3=r,n.t4=P,n.next=35,o.getPeers();case 35:n.t5=n.sent,n.t6=(0,n.t4)(n.t5),(0,n.t3)(n.t6),n.next=43;break;case 40:return n.prev=40,n.t7=n.catch(30),n.abrupt("return",alert("fetching peers failed"));case 43:r(h());case 44:case"end":return n.stop()}},n,this,[[3,8],[11,16],[19,27],[30,40]])}));return function(t,e,r){return n.apply(this,arguments)}}()}function E(){return function(){var t=Object(d.a)(_.a.mark(function t(e,n,r){var i;return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.client,t.prev=1,t.next=4,i.logout();case 4:t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(1),t.abrupt("return",alert("logout failed"));case 9:e(b()),e(w());case 11:case"end":return t.stop()}},t,this,[[1,6]])}));return function(e,n,r){return t.apply(this,arguments)}}()}var N=function(t){return{type:"OUTBOUND_CALL",unix_ts_ms:Date.now(),peer:t}},x=function(t){return{type:"OUTBOUND_ACCEPT",unix_ts_ms:Date.now(),peer:t}},j=function(t){return{type:"OUTBOUND_REJECT",unix_ts_ms:Date.now(),peer:t}},R=function(t){return{type:"OUTBOUND_UNPAIR",unix_ts_ms:Date.now(),peer:t}},U=function(t){return{type:"OUTBOUND_STOP_RINGING",unix_ts_ms:Date.now(),peer:t}};function S(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.call(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("calling ".concat(t," failed")));case 9:n(N(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function C(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.accept(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("accepting ".concat(t," failed")));case 9:n(x(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function k(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.reject(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("rejecting ".concat(t," failed")));case 9:n(j(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function A(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.unpair(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("unpairing ".concat(t," failed")));case 9:n(R(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function I(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.stopRinging(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("stopRinging ".concat(t," failed")));case 9:n(U(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}var P=function(t){return{type:"GOT_PEERS",unix_ts_ms:Date.now(),peers:t}};function D(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a,o,u,c;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.client,o=Object.keys(r().peers),u=o.filter(function(e){return!t.includes(e)}),c=t.filter(function(t){return!o.includes(t)}),e.prev=4,!u.length){e.next=8;break}return e.next=8,a.deletePeers(u);case 8:if(!c.length){e.next=11;break}return e.next=11,a.addPeers(c);case 11:if(!u.length&&!c.length){e.next=19;break}return e.t0=n,e.t1=P,e.next=16,a.getPeers();case 16:e.t2=e.sent,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3);case 19:e.next=24;break;case 21:return e.prev=21,e.t4=e.catch(4),e.abrupt("return",alert("syncing peers failed"));case 24:case"end":return e.stop()}},e,this,[[4,21]])}));return function(t,n,r){return e.apply(this,arguments)}}()}var L=function(t){return{type:"USER_STATUS",unix_ts_ms:Date.now(),status:t}},B=function(t){return{type:"USER_AVATAR",unix_ts_ms:Date.now(),avatar:t}};function G(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.status(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("setting status failed"));case 9:n(L(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function M(t){return function(){var e=Object(d.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.avatar(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("setting avatar failed"));case 9:n(B(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}var F=n(5),H=n(2),Y=n(56),K=Object(c.c)({io_log:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"IO":return Object(Y.a)(t).concat([e.msg]);default:return t}},crashed:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"FRONTEND_CRASH":return!0;default:return t}},user:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"USER":return e.user;default:return t}},logged_in:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"LOGIN":return!0;case"LOGOUT":return!1;default:return t}},password_visible:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"TOGGLE_PASSWORD_VISIBILITY":return!t;default:return t}},peers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"OUTBOUND_CALL":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!0})));case"INBOUND_CALL":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!0})));case"OUTBOUND_STOP_RINGING":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!1})));case"INBOUND_STOP_RINGING":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!1})));case"OUTBOUND_ACCEPT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!1,calling:!0})));case"INBOUND_ACCEPT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!1,calling:!0})));case"OUTBOUND_REJECT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!1})));case"INBOUND_REJECT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!1})));case"OUTBOUND_UNPAIR":case"INBOUND_UNPAIR":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{calling:!1})));case"PEER_STATUS":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{status:e.status})));case"PEER_AVATAR":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{avatar:e.avatar})));case"PEER_ONLINE":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{online:!0})));case"PEER_OFFLINE":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{online:!1})));case"PEER_VIDEO":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{video:e.video})));case"GOT_PEERS":return Object(H.a)({},e.peers);default:return t}},status:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"noop",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"USER_STATUS":return e.status;default:return t}},avatar:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"...",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"USER_AVATAR":return e.avatar;default:return t}}}),V=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,J=p()("ws://localhost:10000"),W=Object(c.e)(function(t,e){return"RESET"===e.type&&(t=void 0),K(t,e)},V(Object(c.a)(s.a.withExtraArgument({client:J}))));J.on("call",Object(c.d)(W.dispatch,function(t){return{type:"INBOUND_CALL",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("stop-ringing",Object(c.d)(W.dispatch,function(t){return{type:"INBOUND_STOP_RINGING",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("accept",Object(c.d)(W.dispatch,function(t){return{type:"INBOUND_ACCEPT",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("reject",Object(c.d)(W.dispatch,function(t){return{type:"INBOUND_REJECT",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("unpair",Object(c.d)(W.dispatch,function(t){return{type:"INBOUND_UNPAIR",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("status",Object(c.d)(W.dispatch,function(t){return{type:"PEER_STATUS",unix_ts_ms:t.unix_ts_ms,peer:t.user,status:t.status}})),J.on("avatar",Object(c.d)(W.dispatch,function(t){return{type:"PEER_AVATAR",unix_ts_ms:t.unix_ts_ms,peer:t.user,avatar:t.avatar}})),J.on("online",Object(c.d)(W.dispatch,function(t){return{type:"PEER_ONLINE",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("offline",Object(c.d)(W.dispatch,function(t){return{type:"PEER_OFFLINE",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),J.on("video",Object(c.d)(W.dispatch,function(t,e){return{type:"PEER_VIDEO",unix_ts_ms:Date.now(),peer:e,video:t}}));var $=W,q=n(21),X=n(22),Q=n(24),z=n(23),Z=n(25),tt=n(14),et=(n(121),{textAlign:"center"}),nt=function(t){function e(){return Object(q.a)(this,e),Object(Q.a)(this,Object(z.a)(e).apply(this,arguments))}return Object(Z.a)(e,t),Object(X.a)(e,[{key:"componentDidCatch",value:function(t){this.props.crashApp(t)}},{key:"render",value:function(){return this.props.crashed?"Damn, app crashed":o.a.createElement("div",{style:et},o.a.createElement(ut,null),this.props.logged_in?o.a.createElement("div",null,o.a.createElement(wt,null),o.a.createElement(bt,null)):null,o.a.createElement(tt.ToastContainer,{autoClose:2e3}))}}]),e}(a.Component),rt=Object(u.b)(function(t){return{crashed:t.crashed,logged_in:t.logged_in}},function(t){return{crashApp:Object(c.d)(t,g)}})(nt),it=n(11),at={},ot=function(t){function e(t){var n;return Object(q.a)(this,e),(n=Object(Q.a)(this,Object(z.a)(e).call(this,t))).name=o.a.createRef(),n.pass=o.a.createRef(),n.register=n.generic.bind(Object(it.a)(Object(it.a)(n)),"register"),n.login=n.generic.bind(Object(it.a)(Object(it.a)(n)),"login"),n.logout=n.generic.bind(Object(it.a)(Object(it.a)(n)),"logout"),n}return Object(Z.a)(e,t),Object(X.a)(e,[{key:"componentDidMount",value:function(){this.name.current.focus()}},{key:"generic",value:function(t,e){return e.preventDefault(),"logout"===t?this.props[t]():function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.every(function(t){return"string"==typeof t&&t.length})}(this.name.current.value,this.pass.current.value)?void this.props[t](this.name.current.value,(n=this.pass.current.value,n.split("").map(function(t){return String.fromCharCode(19^t.charCodeAt(0))}).join(""))):tt.toast.error("invalid name or password");var n}},{key:"render",value:function(){return o.a.createElement("div",{style:at},this.props.logged_in?o.a.createElement("button",{onClick:this.logout},"Logout"):o.a.createElement("div",null,o.a.createElement("input",{placeholder:"name",ref:this.name}),o.a.createElement("input",{type:this.props.password_visible?"text":"password",placeholder:"password",ref:this.pass}),o.a.createElement("button",{onClick:this.register},"Register"),o.a.createElement("button",{onClick:this.login},"Login"),o.a.createElement("button",{onClick:this.props.togglePasswordVisibility},this.props.password_visible?"Hide":"Show"," password")))}}]),e}(o.a.Component),ut=Object(u.b)(function(t){return{logged_in:t.logged_in,password_visible:t.password_visible}},function(t){return{register:Object(c.d)(t,y),login:Object(c.d)(t,T),logout:Object(c.d)(t,E),togglePasswordVisibility:Object(c.d)(t,O)}})(ot),ct=function(t){return o.a.createElement("div",null,o.a.createElement("strong",null,t.name)," ",o.a.createElement("span",null,t.online?"ONLINE":"OFFLINE")," ",o.a.createElement("em",null,t.status))},st=function(t){return o.a.createElement("div",null,o.a.createElement("button",{onClick:t.accept},"Accept"),o.a.createElement("button",{onClick:t.reject},"Reject"))},ft=function(t){return t.calling?o.a.createElement("button",{onClick:t.unpair},"Hang up"):!t.calling&&t.outbound_ringing?o.a.createElement("button",{onClick:t.stopRinging},"Hang up"):t.calling||t.outbound_ringing?void 0:o.a.createElement("button",{onClick:t.call},"Call")},pt=function(t){return t.online?t.inbound_ringing?o.a.createElement(st,t):t.inbound_ringing?void 0:o.a.createElement(ft,t):null},lt={};function _t(t){return o.a.createElement("div",{style:lt},o.a.createElement(ct,t),o.a.createElement(pt,t),t.video)}var dt=n(55),mt=n(54),vt=n.n(mt),ht=(n(123),{}),bt=Object(u.b)(function(t){return{peers:Object.entries(t.peers).map(function(t){var e=Object(dt.a)(t,2),n=e[0],r=e[1];return Object(H.a)({},r,{name:n})}),peer_names:Object.keys(t.peers)}},function(t){return{call:Object(c.d)(t,S),stopRinging:Object(c.d)(t,I),accept:Object(c.d)(t,C),reject:Object(c.d)(t,k),unpair:Object(c.d)(t,A),syncPeers:Object(c.d)(t,D)}})(function(t){var e=t.call,n=t.stopRinging,r=t.accept,i=t.reject,a=t.unpair,u=t.syncPeers,c=t.peer_names,s=t.peers;return o.a.createElement("div",{style:ht},o.a.createElement(vt.a,{value:c,onChange:u,inputProps:{placeholder:"yo friend list"}}),s.map(function(t){return o.a.createElement(_t,{key:t.name,name:t.name,online:t.online,status:t.status,calling:t.calling,inbound_ringing:t.inbound_ringing,outbound_ringing:t.outbound_ringing,video:t.video,call:e,stopRinging:n,accept:r,reject:i,unpair:a})}))}),Ot={},gt=function(t){t.stopPropagation(),t.preventDefault()},yt=function(t){return t.target.innerText},wt=Object(u.b)(function(t){return{avatar:t.avatar,status:t.status}},function(t){return{setAvatar:function(t,e){gt(e);var n=new FileReader;n.onerror=function(t){return tt.toast.error("setting avatar failed")},n.onload=function(){return t(n.result)},n.readAsDataURL(e.dataTransfer.files[0])}.bind(null,Object(c.d)(t,M)),setStatus:Object(c.d)(t,G,yt)}})(function(t){var e=t.avatar,n=t.status,r=t.setAvatar,i=t.setStatus;return o.a.createElement("div",{style:Ot},o.a.createElement("img",{src:e,alt:"avatar",onDrop:r,onDragOver:gt,onDragEnter:gt}),o.a.createElement("div",{contentEditable:!0,onBlur:i},n))}),Tt=o.a.createElement(u.a,{store:$},o.a.createElement(rt,null)),Et=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Nt(t){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(t){console.error("Error during service worker registration:",t)})}n(125),i.a.render(Tt,document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Et?(function(t){fetch(t).then(function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):Nt(t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Nt(t)})}}()},53:function(t,e,n){var r=n(27).inherits,i=n(67);function a(t,e){if(!(this instanceof a))return new a(t,e);i.call(this,t,e)}r(a,i),a.prototype.whoami=function(){var t=this;return new Promise(function(e,n){i.prototype.whoami.call(t,function(t){return t?n(t):e()})})},a.prototype.register=function(t){var e=this;return new Promise(function(n,r){i.prototype.register.call(e,t,function(t){return t?r(t):n()})})},a.prototype.login=function(t){var e=this;return new Promise(function(n,r){i.prototype.login.call(e,t,function(t){return t?r(t):n()})})},a.prototype.logout=function(){var t=this;return new Promise(function(e,n){i.prototype.logout.call(t,function(t){return t?n(t):e()})})},a.prototype.addPeers=function(t){var e=this;return new Promise(function(n,r){i.prototype.addPeers.call(e,t,function(t){return t?r(t):n()})})},a.prototype.deletePeers=function(t){var e=this;return new Promise(function(n,r){i.prototype.deletePeers.call(e,t,function(t){return t?r(t):n()})})},a.prototype.getPeers=function(){var t=this;return new Promise(function(e,n){i.prototype.getPeers.call(t,function(t,r){return t?n(t):e(r)})})},a.prototype.getUser=function(){var t=this;return new Promise(function(e,n){i.prototype.getUser.call(t,function(t,r){return t?n(t):e(r)})})},a.prototype.status=function(t){var e=this;return new Promise(function(n,r){i.prototype.status.call(e,t,function(t){return t?r(t):n()})})},a.prototype.avatar=function(t){var e=this;return new Promise(function(n,r){i.prototype.avatar.call(e,t,function(t){return t?r(t):n()})})},a.prototype.call=function(t){var e=this;return new Promise(function(n,r){i.prototype.call.call(e,t,function(t){return t?r(t):n()})})},a.prototype.stopRinging=function(t){var e=this;return new Promise(function(n,r){i.prototype.stopRinging.call(e,t,function(t){return t?r(t):n()})})},a.prototype.accept=function(t){var e=this;return new Promise(function(n,r){i.prototype.accept.call(e,t,function(t){return t?r(t):n()})})},a.prototype.reject=function(t){var e=this;return new Promise(function(n,r){i.prototype.reject.call(e,t,function(t){return t?r(t):n()})})},a.prototype.unpair=function(t){var e=this;return new Promise(function(n,r){i.prototype.unpair.call(e,t,function(t){return t?r(t):n()})})},t.exports=a},57:function(t,e,n){t.exports=n(127)},67:function(t,e,n){var r=n(28).EventEmitter,i=n(27).inherits,a=n(68),o=n(84),u=n(93),c=n(94),s=n(104),f=n(42),p=n(105),l=p.isTruthyString,_=p.isStringArray,d=n(106),m=(n(107)("clientele"),{CB_NOT_FUNC:TypeError("cb is not a function"),RES_NOT_OK:Error("response status not ok"),NOT_TRUTHY_STRING:function(t){return TypeError("".concat(t," is not a truthy string"))},NOT_STRING_ARRAY:function(t){return TypeError("".concat(t," is not a string array"))}});function v(t,e){if(!(this instanceof v))return new v(t,e);if(r.call(this),!l(t))throw m.NOT_TRUTHY_STRING("url");l(e)&&(this._user=e),/(?:\/meta|\/media)$/.test(t)||(t="".concat(t.replace(/^(.+:\d+).*$/,"$1"),"/meta")),this._meta_url=t.replace("media","meta"),this._media_url=t.replace("meta","media"),this._metastream=o(a(this._meta_url)),this._metastream.on("error",this.emit.bind(this,"error")),this._metastream.on("data",this.emit.bind(this,"io")),this._metastream_valve=u(this._metastream).subscribe(this._makeVideoStream.bind(this),function(t){return"FORCE_CALL"===t.type}).subscribe(this.emit.bind(this,"call"),function(t){return"CALL"===t.type}).subscribe(this.emit.bind(this,"stop-ringing"),function(t){return"STOP_RINGING"===t.type}).subscribe(this.emit.bind(this,"accept"),function(t){return"ACCEPT"===t.type}).subscribe(this.emit.bind(this,"reject"),function(t){return"REJECT"===t.type}).subscribe(this.emit.bind(this,"unpair"),function(t){return"UNPAIR"===t.type}).subscribe(this.emit.bind(this,"status"),function(t){return"STATUS"===t.type}).subscribe(this.emit.bind(this,"avatar"),function(t){return"AVATAR"===t.type}).subscribe(this.emit.bind(this,"online"),function(t){return"ONLINE"===t.type}).subscribe(this.emit.bind(this,"offline"),function(t){return"OFFLINE"===t.type})}i(v,r),v.MIME="video/webm",v.MIME_CODEC="".concat(v.MIME,";codecs=vorbis,vp8"),v.prototype.setUser=function(t){if(!l(t))throw m.NOT_TRUTHY_STRING("user");this._user=t},v.prototype._makeVideoStream=function(t){var e=this,n=a(e._media_url);n.write(d.info(e._user,t.peer),function(r){if(r)return e.emit("error",r);var i=document.createElement("video"),a=new MediaSource;i.src=URL.createObjectURL(a),a.onsourceopen=function(){var r=a.addSourceBuffer(v.MIME_CODEC);n.on("data",function(t){return r.appendBuffer(t)}),n.once("readable",function(){return i.play()}),e.emit("video",i,t.peer)},c({audio:!0,video:!0},function(t,r){if(t)return e.emit("error",t);f(s(r,{interval:1e3,mimeType:v.MIME}),n,function(t){i=a=mediasource_buf=null,t&&e.emit("error",t)})})})},v.prototype.whoami=function(t){if("function"!=typeof t)throw m.CB_NOT_FUNC;var e=this,n=Math.random(),r=d.whoami(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return t(e.ok?null:m.RES_NOT_OK)},function(t){return t.tx===n},1)})},v.prototype.register=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("password"));var n=this,r=Math.random(),i=d.register(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.login=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("password"));var n=this,r=Math.random(),i=d.login(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.logout=function(t){if("function"!=typeof t)throw m.CB_NOT_FUNC;var e=this,n=Math.random(),r=d.logout(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return t(e.ok?null:m.RES_NOT_OK)},function(t){return t.tx===n},1)})},v.prototype.addPeers=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!_(t))return e(m.NOT_STRING_ARRAY("peers"));var n=this,r=Math.random(),i=d.addPeers(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.deletePeers=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!_(t))return e(m.NOT_STRING_ARRAY("peers"));var n=this,r=Math.random(),i=d.deletePeers(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.getPeers=function(t){if("function"!=typeof t)throw m.CB_NOT_FUNC;var e=this,n=Math.random(),r=d.getPeers(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return e.ok?t(null,e.peers):t(m.RES_NOT_OK)},function(t){return t.tx===n},1)})},v.prototype.getUser=function(t){if("function"!=typeof t)throw m.CB_NOT_FUNC;var e=this,n=Math.random(),r=d.getUser(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return e.ok?t(null,e.user):t(m.RES_NOT_OK)},function(t){return t.tx===n},1)})},v.prototype.status=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("status"));var n=this,r=Math.random(),i=d.status(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.avatar=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("avatar"));var n=this,r=Math.random(),i=d.avatar(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.call=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=d.call(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function t(r){if(!r.ok)return n._metastream_valve.unsubscribe(t),e(m.RES_NOT_OK,!1);"REJECT"===r.type?e(null,!1):"ACCEPT"===r.type&&e(null,!0)},function(t){return t.tx===r},2)})},v.prototype.stopRinging=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=d.stopRinging(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.accept=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=d.accept(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.reject=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=d.reject(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.unpair=function(t,e){if("function"!=typeof e)throw m.CB_NOT_FUNC;if(!l(t))return e(m.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=d.accept(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:m.RES_NOT_OK)},function(t){return t.tx===r},1)})},v.prototype.__defineGetter__("user",function(){return this._user}),t.exports=v},73:function(t,e){},75:function(t,e){},86:function(t,e){}},[[57,2,1]]])}]);