(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(t,e){var n=function(t){return t&&"string"===typeof t};t.exports={isTruthyString:n,isStringArray:function(t){return Array.isArray(t)&&t.every(n)}}},106:function(t,e){var n={whoami:function(t,e){return{type:"WHOAMI",user:t,tx:e,unix_ts_ms:Date.now()}},register:function(t,e,n){return{type:"REGISTER",user:t,password:e,tx:n,unix_ts_ms:Date.now()}},login:function(t,e,n){return{type:"LOGIN",user:t,password:e,tx:n,unix_ts_ms:Date.now()}},logout:function(t,e){return{type:"LOGOUT",user:t,tx:e,unix_ts_ms:Date.now()}},addPeers:function(t,e,n){return{type:"ADD_PEERS",user:t,peers:e,tx:n,unix_ts_ms:Date.now()}},deletePeers:function(t,e,n){return{type:"DEL_PEERS",user:t,peers:e,tx:n,unix_ts_ms:Date.now()}},getPeers:function(t,e){return{type:"GET_PEERS",user:t,tx:e,unix_ts_ms:Date.now()}},getUser:function(t,e){return{type:"GET_USER",user:t,tx:e,unix_ts_ms:Date.now()}},status:function(t,e,n){return{type:"STATUS",user:t,status:e,tx:n,unix_ts_ms:Date.now()}},call:function(t,e,n){return{type:"CALL",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},accept:function(t,e,n){return{type:"ACCEPT",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},reject:function(t,e,n){return{type:"REJECT",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},unpair:function(t,e,n){return{type:"UNPAIR",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}},info:function(t,e){return JSON.stringify({user:t,peer:e,unix_ts_ms:Date.now()})},avatar:function(t,e,n){return{type:"AVATAR",user:t,avatar:e,tx:n,unix_ts_ms:Date.now()}},stopRinging:function(t,e,n){return{type:"STOP_RINGING",user:t,peer:e,tx:n,unix_ts_ms:Date.now()}}};t.exports=n},125:function(t,e,n){},127:function(t,e,n){"use strict";n.r(e);var r=n(31),i=n.n(r),a=n(0),u=n.n(a),o=n(10),c=n(1),s=n(52),p=n(53),f=n.n(p),l=n(3),_=n.n(l),m=n(6);var d=function(t,e){return{type:"FRONTEND_CRASH",unix_ts_ms:Date.now(),err_name:t.name,err_message:t.message,err_stack:t.stack,err_fileName:t.fileName,err_lineNumber:t.lineNumber,err_columnNumber:t.columnNumber,state:e}},h=function(t){return{type:"USER",unix_ts_ms:Date.now(),user:t}},v=function(){return{type:"LOGIN",unix_ts_ms:Date.now()}},b=function(){return{type:"LOGOUT",unix_ts_ms:Date.now()}};function O(){return{type:"TOGGLE_PASSWORD_VISIBILITY",unix_ts_ms:Date.now()}}function g(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r){var i,a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=d(t,r()),n(i),a={method:"post",body:JSON.stringify(i)},e.prev=3,e.next=6,fetch("http://localhost:10000/crash",a);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(3);case 10:case"end":return e.stop()}},e,this,[[3,8]])}));return function(t,n){return e.apply(this,arguments)}}()}function y(t,e){return function(){var n=Object(m.a)(_.a.mark(function n(r,i,a){var u;return _.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=a.client,r(h(t)),u.setUser(t),n.prev=3,n.next=6,u.whoami();case 6:n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(3),n.abrupt("return",alert("identification failed"));case 11:return n.prev=11,n.next=14,u.register(e);case 14:n.next=19;break;case 16:return n.prev=16,n.t1=n.catch(11),n.abrupt("return",alert("registration failed"));case 19:r(T(t,e));case 20:case"end":return n.stop()}},n,this,[[3,8],[11,16]])}));return function(t,e,r){return n.apply(this,arguments)}}()}var w=function(){return{type:"RESET",unix_ts_ms:Date.now()}};function T(t,e){return function(){var n=Object(m.a)(_.a.mark(function n(r,i,a){var u,o;return _.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=a.client,t!==i().user&&r(h(t)),t!==u.user&&u.setUser(t),n.prev=3,n.next=6,u.whoami();case 6:n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(3),n.abrupt("return",alert("identification failed"));case 11:return n.prev=11,n.next=14,u.login(e);case 14:n.next=19;break;case 16:return n.prev=16,n.t1=n.catch(11),n.abrupt("return",alert("login failed"));case 19:return n.prev=19,n.next=22,u.getUser();case 22:o=n.sent,r(G(o.avatar)),r(B(o.status)),n.next=30;break;case 27:return n.prev=27,n.t2=n.catch(19),n.abrupt("return",alert("fetching user data failed"));case 30:return n.prev=30,n.t3=r,n.t4=D,n.next=35,u.getPeers();case 35:n.t5=n.sent,n.t6=(0,n.t4)(n.t5),(0,n.t3)(n.t6),n.next=43;break;case 40:return n.prev=40,n.t7=n.catch(30),n.abrupt("return",alert("fetching peers failed"));case 43:r(v());case 44:case"end":return n.stop()}},n,this,[[3,8],[11,16],[19,27],[30,40]])}));return function(t,e,r){return n.apply(this,arguments)}}()}function E(){return function(){var t=Object(m.a)(_.a.mark(function t(e,n,r){var i;return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.client,t.prev=1,t.next=4,i.logout();case 4:t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(1),t.abrupt("return",alert("logout failed"));case 9:e(b()),e(w());case 11:case"end":return t.stop()}},t,this,[[1,6]])}));return function(e,n,r){return t.apply(this,arguments)}}()}var N=function(t){return{type:"OUTBOUND_CALL",unix_ts_ms:Date.now(),peer:t}},x=function(t){return{type:"OUTBOUND_ACCEPT",unix_ts_ms:Date.now(),peer:t}},R=function(t){return{type:"OUTBOUND_REJECT",unix_ts_ms:Date.now(),peer:t}},j=function(t){return{type:"OUTBOUND_UNPAIR",unix_ts_ms:Date.now(),peer:t}},U=function(t){return{type:"OUTBOUND_STOP_RINGING",unix_ts_ms:Date.now(),peer:t}};function S(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.call(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("calling ".concat(t," failed")));case 9:n(N(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function C(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.accept(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("accepting ".concat(t," failed")));case 9:n(x(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function k(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.reject(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("rejecting ".concat(t," failed")));case 9:n(R(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function P(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.unpair(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("unpairing ".concat(t," failed")));case 9:n(j(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function I(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.stopRinging(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("stopRinging ".concat(t," failed")));case 9:n(U(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}var D=function(t){return{type:"GOT_PEERS",unix_ts_ms:Date.now(),peers:t}};function A(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a,u,o,c;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.client,u=Object.keys(r().peers),o=u.filter(function(e){return!t.includes(e)}),c=t.filter(function(t){return!u.includes(t)}),e.prev=4,!o.length){e.next=8;break}return e.next=8,a.deletePeers(o);case 8:if(!c.length){e.next=11;break}return e.next=11,a.addPeers(c);case 11:if(!o.length&&!c.length){e.next=19;break}return e.t0=n,e.t1=D,e.next=16,a.getPeers();case 16:e.t2=e.sent,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3);case 19:e.next=24;break;case 21:return e.prev=21,e.t4=e.catch(4),e.abrupt("return",alert("syncing peers failed"));case 24:case"end":return e.stop()}},e,this,[[4,21]])}));return function(t,n,r){return e.apply(this,arguments)}}()}var B=function(t){return{type:"USER_STATUS",unix_ts_ms:Date.now(),status:t}},G=function(t){return{type:"USER_AVATAR",unix_ts_ms:Date.now(),avatar:t}};function L(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.status(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("setting status failed"));case 9:n(B(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}function M(t){return function(){var e=Object(m.a)(_.a.mark(function e(n,r,i){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.client,e.prev=1,e.next=4,a.avatar(t);case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",alert("setting avatar failed"));case 9:n(G(t));case 10:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t,n,r){return e.apply(this,arguments)}}()}var F=n(5),H=n(2),Y=n(56),K=Object(c.c)({io_log:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"IO":return Object(Y.a)(t).concat([e.msg]);default:return t}},crashed:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"FRONTEND_CRASH":return!0;default:return t}},user:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"USER":return e.user;default:return t}},logged_in:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"LOGIN":return!0;case"LOGOUT":return!1;default:return t}},password_visible:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"TOGGLE_PASSWORD_VISIBILITY":return!t;default:return t}},peers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"OUTBOUND_CALL":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!0})));case"INBOUND_CALL":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!0})));case"OUTBOUND_STOP_RINGING":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!1})));case"INBOUND_STOP_RINGING":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!1})));case"OUTBOUND_ACCEPT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!1,calling:!0})));case"INBOUND_ACCEPT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!1,calling:!0})));case"OUTBOUND_REJECT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{inbound_ringing:!1})));case"INBOUND_REJECT":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{outbound_ringing:!1})));case"OUTBOUND_UNPAIR":case"INBOUND_UNPAIR":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{calling:!1})));case"PEER_STATUS":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{status:e.status})));case"PEER_AVATAR":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{avatar:e.avatar})));case"PEER_ONLINE":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{online:!0})));case"PEER_OFFLINE":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{online:!1})));case"PEER_VIDEO":return Object(H.a)({},t,Object(F.a)({},e.peer,Object(H.a)({},t[e.peer],{video:e.video})));case"GOT_PEERS":return Object(H.a)({},e.peers);default:return t}},status:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"noop",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"USER_STATUS":return e.status;default:return t}},avatar:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"...",e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"USER_AVATAR":return e.avatar;default:return t}}}),V=function(t,e){return"RESET"===e.type&&(t=void 0),K(t,e)},J=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,W=f()("ws://localhost:10000"),$=Object(c.e)(V,J(Object(c.a)(s.a.withExtraArgument({client:W}))));W.on("call",Object(c.d)($.dispatch,function(t){return{type:"INBOUND_CALL",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("stop-ringing",Object(c.d)($.dispatch,function(t){return{type:"INBOUND_STOP_RINGING",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("accept",Object(c.d)($.dispatch,function(t){return{type:"INBOUND_ACCEPT",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("reject",Object(c.d)($.dispatch,function(t){return{type:"INBOUND_REJECT",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("unpair",Object(c.d)($.dispatch,function(t){return{type:"INBOUND_UNPAIR",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("status",Object(c.d)($.dispatch,function(t){return{type:"PEER_STATUS",unix_ts_ms:t.unix_ts_ms,peer:t.user,status:t.status}})),W.on("avatar",Object(c.d)($.dispatch,function(t){return{type:"PEER_AVATAR",unix_ts_ms:t.unix_ts_ms,peer:t.user,avatar:t.avatar}})),W.on("online",Object(c.d)($.dispatch,function(t){return{type:"PEER_ONLINE",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("offline",Object(c.d)($.dispatch,function(t){return{type:"PEER_OFFLINE",unix_ts_ms:t.unix_ts_ms,peer:t.user}})),W.on("video",Object(c.d)($.dispatch,function(t,e){return{type:"PEER_VIDEO",unix_ts_ms:Date.now(),peer:e,video:t}}));var X=$,Q=n(21),q=n(22),z=n(24),Z=n(23),tt=n(25),et=n(14),nt=(n(121),{textAlign:"center"}),rt=function(t){function e(){return Object(Q.a)(this,e),Object(z.a)(this,Object(Z.a)(e).apply(this,arguments))}return Object(tt.a)(e,t),Object(q.a)(e,[{key:"componentDidCatch",value:function(t){this.props.crashApp(t)}},{key:"render",value:function(){return this.props.crashed?"Damn, app crashed":u.a.createElement("div",{style:nt},u.a.createElement(ct,null),this.props.logged_in?u.a.createElement("div",null,u.a.createElement(Tt,null),u.a.createElement(Ot,null)):null,u.a.createElement(et.ToastContainer,{autoClose:2e3}))}}]),e}(a.Component),it=Object(o.b)(function(t){return{crashed:t.crashed,logged_in:t.logged_in}},function(t){return{crashApp:Object(c.d)(t,g)}})(rt),at=n(11);var ut={},ot=function(t){function e(t){var n;return Object(Q.a)(this,e),(n=Object(z.a)(this,Object(Z.a)(e).call(this,t))).name=u.a.createRef(),n.pass=u.a.createRef(),n.register=n.generic.bind(Object(at.a)(Object(at.a)(n)),"register"),n.login=n.generic.bind(Object(at.a)(Object(at.a)(n)),"login"),n.logout=n.generic.bind(Object(at.a)(Object(at.a)(n)),"logout"),n}return Object(tt.a)(e,t),Object(q.a)(e,[{key:"componentDidMount",value:function(){this.name.current.focus()}},{key:"generic",value:function(t,e){return e.preventDefault(),"logout"===t?this.props[t]():function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.every(function(t){return"string"===typeof t&&t.length})}(this.name.current.value,this.pass.current.value)?void this.props[t](this.name.current.value,(n=this.pass.current.value,n.split("").map(function(t){return String.fromCharCode(19^t.charCodeAt(0))}).join(""))):et.toast.error("invalid name or password");var n}},{key:"render",value:function(){return u.a.createElement("div",{style:ut},this.props.logged_in?u.a.createElement("button",{onClick:this.logout},"Logout"):u.a.createElement("div",null,u.a.createElement("input",{placeholder:"name",ref:this.name}),u.a.createElement("input",{type:this.props.password_visible?"text":"password",placeholder:"password",ref:this.pass}),u.a.createElement("button",{onClick:this.register},"Register"),u.a.createElement("button",{onClick:this.login},"Login"),u.a.createElement("button",{onClick:this.props.togglePasswordVisibility},this.props.password_visible?"Hide":"Show"," password")))}}]),e}(u.a.Component),ct=Object(o.b)(function(t){return{logged_in:t.logged_in,password_visible:t.password_visible}},function(t){return{register:Object(c.d)(t,y),login:Object(c.d)(t,T),logout:Object(c.d)(t,E),togglePasswordVisibility:Object(c.d)(t,O)}})(ot),st=function(t){return u.a.createElement("div",null,u.a.createElement("strong",null,t.name),"\xa0",u.a.createElement("span",null,t.online?"ONLINE":"OFFLINE"),"\xa0",u.a.createElement("em",null,t.status))},pt=function(t){return u.a.createElement("div",null,u.a.createElement("button",{onClick:t.accept},"Accept"),u.a.createElement("button",{onClick:t.reject},"Reject"))},ft=function(t){return t.calling?u.a.createElement("button",{onClick:t.unpair},"Hang up"):!t.calling&&t.outbound_ringing?u.a.createElement("button",{onClick:t.stopRinging},"Hang up"):t.calling||t.outbound_ringing?void 0:u.a.createElement("button",{onClick:t.call},"Call")},lt=function(t){return t.online?t.inbound_ringing?u.a.createElement(pt,t):t.inbound_ringing?void 0:u.a.createElement(ft,t):null},_t={};function mt(t){return u.a.createElement("div",{style:_t},u.a.createElement(st,t),u.a.createElement(lt,t),t.video)}var dt=n(55),ht=n(54),vt=n.n(ht),bt=(n(123),{}),Ot=Object(o.b)(function(t){return{peers:Object.entries(t.peers).map(function(t){var e=Object(dt.a)(t,2),n=e[0],r=e[1];return Object(H.a)({},r,{name:n})}),peer_names:Object.keys(t.peers)}},function(t){return{call:Object(c.d)(t,S),stopRinging:Object(c.d)(t,I),accept:Object(c.d)(t,C),reject:Object(c.d)(t,k),unpair:Object(c.d)(t,P),syncPeers:Object(c.d)(t,A)}})(function(t){var e=t.call,n=t.stopRinging,r=t.accept,i=t.reject,a=t.unpair,o=t.syncPeers,c=t.peer_names,s=t.peers;return u.a.createElement("div",{style:bt},u.a.createElement(vt.a,{value:c,onChange:o,inputProps:{placeholder:"yo friend list"}}),s.map(function(t){return u.a.createElement(mt,{key:t.name,name:t.name,online:t.online,status:t.status,calling:t.calling,inbound_ringing:t.inbound_ringing,outbound_ringing:t.outbound_ringing,video:t.video,call:e,stopRinging:n,accept:r,reject:i,unpair:a})}))}),gt={},yt=function(t){t.stopPropagation(),t.preventDefault()},wt=function(t){return t.target.innerText},Tt=Object(o.b)(function(t){return{avatar:t.avatar,status:t.status}},function(t){return{setAvatar:function(t,e){yt(e);var n=new FileReader;n.onerror=function(t){return et.toast.error("setting avatar failed")},n.onload=function(){return t(n.result)},n.readAsDataURL(e.dataTransfer.files[0])}.bind(null,Object(c.d)(t,M)),setStatus:Object(c.d)(t,L,wt)}})(function(t){var e=t.avatar,n=t.status,r=t.setAvatar,i=t.setStatus;return u.a.createElement("div",{style:gt},u.a.createElement("img",{src:e,alt:"avatar",onDrop:r,onDragOver:yt,onDragEnter:yt}),u.a.createElement("div",{contentEditable:!0,onBlur:i},n))}),Et=u.a.createElement(o.a,{store:X},u.a.createElement(it,null)),Nt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function xt(t){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(t){console.error("Error during service worker registration:",t)})}n(125);i.a.render(Et,document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Nt?(function(t){fetch(t).then(function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):xt(t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):xt(t)})}}()},53:function(t,e,n){var r=n(27).inherits,i=n(67);function a(t,e){if(!(this instanceof a))return new a(t,e);i.call(this,t,e)}r(a,i),a.prototype.whoami=function(){var t=this;return new Promise(function(e,n){i.prototype.whoami.call(t,function(t){return t?n(t):e()})})},a.prototype.register=function(t){var e=this;return new Promise(function(n,r){i.prototype.register.call(e,t,function(t){return t?r(t):n()})})},a.prototype.login=function(t){var e=this;return new Promise(function(n,r){i.prototype.login.call(e,t,function(t){return t?r(t):n()})})},a.prototype.logout=function(){var t=this;return new Promise(function(e,n){i.prototype.logout.call(t,function(t){return t?n(t):e()})})},a.prototype.addPeers=function(t){var e=this;return new Promise(function(n,r){i.prototype.addPeers.call(e,t,function(t){return t?r(t):n()})})},a.prototype.deletePeers=function(t){var e=this;return new Promise(function(n,r){i.prototype.deletePeers.call(e,t,function(t){return t?r(t):n()})})},a.prototype.getPeers=function(){var t=this;return new Promise(function(e,n){i.prototype.getPeers.call(t,function(t,r){return t?n(t):e(r)})})},a.prototype.getUser=function(){var t=this;return new Promise(function(e,n){i.prototype.getUser.call(t,function(t,r){return t?n(t):e(r)})})},a.prototype.status=function(t){var e=this;return new Promise(function(n,r){i.prototype.status.call(e,t,function(t){return t?r(t):n()})})},a.prototype.avatar=function(t){var e=this;return new Promise(function(n,r){i.prototype.avatar.call(e,t,function(t){return t?r(t):n()})})},a.prototype.call=function(t){var e=this;return new Promise(function(n,r){i.prototype.call.call(e,t,function(t){return t?r(t):n()})})},a.prototype.stopRinging=function(t){var e=this;return new Promise(function(n,r){i.prototype.stopRinging.call(e,t,function(t){return t?r(t):n()})})},a.prototype.accept=function(t){var e=this;return new Promise(function(n,r){i.prototype.accept.call(e,t,function(t){return t?r(t):n()})})},a.prototype.reject=function(t){var e=this;return new Promise(function(n,r){i.prototype.reject.call(e,t,function(t){return t?r(t):n()})})},a.prototype.unpair=function(t){var e=this;return new Promise(function(n,r){i.prototype.unpair.call(e,t,function(t){return t?r(t):n()})})},t.exports=a},57:function(t,e,n){t.exports=n(127)},67:function(t,e,n){var r=n(28).EventEmitter,i=n(27).inherits,a=n(68),u=n(84),o=n(93),c=n(94),s=n(104),p=n(42),f=n(105),l=f.isTruthyString,_=f.isStringArray,m=n(106),d=(n(107)("clientele"),{CB_NOT_FUNC:TypeError("cb is not a function"),RES_NOT_OK:Error("response status not ok"),NOT_TRUTHY_STRING:function(t){return TypeError("".concat(t," is not a truthy string"))},NOT_STRING_ARRAY:function(t){return TypeError("".concat(t," is not a string array"))}});function h(t,e){if(!(this instanceof h))return new h(t,e);if(r.call(this),!l(t))throw d.NOT_TRUTHY_STRING("url");l(e)&&(this._user=e),/(?:\/meta|\/media)$/.test(t)||(t="".concat(t.replace(/^(.+:\d+).*$/,"$1"),"/meta")),this._meta_url=t.replace("media","meta"),this._media_url=t.replace("meta","media"),this._metastream=u(a(this._meta_url)),this._metastream.on("error",this.emit.bind(this,"error")),this._metastream.on("data",this.emit.bind(this,"io")),this._metastream_valve=o(this._metastream).subscribe(this._makeVideoStream.bind(this),function(t){return"FORCE_CALL"===t.type}).subscribe(this.emit.bind(this,"call"),function(t){return"CALL"===t.type}).subscribe(this.emit.bind(this,"stop-ringing"),function(t){return"STOP_RINGING"===t.type}).subscribe(this.emit.bind(this,"accept"),function(t){return"ACCEPT"===t.type}).subscribe(this.emit.bind(this,"reject"),function(t){return"REJECT"===t.type}).subscribe(this.emit.bind(this,"unpair"),function(t){return"UNPAIR"===t.type}).subscribe(this.emit.bind(this,"status"),function(t){return"STATUS"===t.type}).subscribe(this.emit.bind(this,"avatar"),function(t){return"AVATAR"===t.type}).subscribe(this.emit.bind(this,"online"),function(t){return"ONLINE"===t.type}).subscribe(this.emit.bind(this,"offline"),function(t){return"OFFLINE"===t.type})}i(h,r),h.MIME="video/webm",h.MIME_CODEC="".concat(h.MIME,";codecs=vorbis,vp8"),h.prototype.setUser=function(t){if(!l(t))throw d.NOT_TRUTHY_STRING("user");this._user=t},h.prototype._makeVideoStream=function(t){var e=this,n=a(e._media_url);n.write(m.info(e._user,t.peer),function(r){if(r)return e.emit("error",r);var i=document.createElement("video"),a=new MediaSource;i.src=URL.createObjectURL(a),a.onsourceopen=function(){var r=a.addSourceBuffer(h.MIME_CODEC);n.on("data",function(t){return r.appendBuffer(t)}),n.once("readable",function(){return i.play()}),e.emit("video",i,t.peer)},c({audio:!0,video:!0},function(t,r){if(t)return e.emit("error",t);p(s(r,{interval:1e3,mimeType:h.MIME}),n,function(t){i=a=mediasource_buf=null,t&&e.emit("error",t)})})})},h.prototype.whoami=function(t){if("function"!==typeof t)throw d.CB_NOT_FUNC;var e=this,n=Math.random(),r=m.whoami(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return t(e.ok?null:d.RES_NOT_OK)},function(t){return t.tx===n},1)})},h.prototype.register=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("password"));var n=this,r=Math.random(),i=m.register(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.login=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("password"));var n=this,r=Math.random(),i=m.login(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.logout=function(t){if("function"!==typeof t)throw d.CB_NOT_FUNC;var e=this,n=Math.random(),r=m.logout(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return t(e.ok?null:d.RES_NOT_OK)},function(t){return t.tx===n},1)})},h.prototype.addPeers=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!_(t))return e(d.NOT_STRING_ARRAY("peers"));var n=this,r=Math.random(),i=m.addPeers(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.deletePeers=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!_(t))return e(d.NOT_STRING_ARRAY("peers"));var n=this,r=Math.random(),i=m.deletePeers(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.getPeers=function(t){if("function"!==typeof t)throw d.CB_NOT_FUNC;var e=this,n=Math.random(),r=m.getPeers(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return e.ok?t(null,e.peers):t(d.RES_NOT_OK)},function(t){return t.tx===n},1)})},h.prototype.getUser=function(t){if("function"!==typeof t)throw d.CB_NOT_FUNC;var e=this,n=Math.random(),r=m.getUser(e._user,n);e._metastream.write(r,function(i){if(i)return t(i);e.emit("io",r),e._metastream_valve.subscribe(function(e){return e.ok?t(null,e.user):t(d.RES_NOT_OK)},function(t){return t.tx===n},1)})},h.prototype.status=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("status"));var n=this,r=Math.random(),i=m.status(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.avatar=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("avatar"));var n=this,r=Math.random(),i=m.avatar(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.call=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=m.call(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function t(r){if(!r.ok)return n._metastream_valve.unsubscribe(t),e(d.RES_NOT_OK,!1);"REJECT"===r.type?e(null,!1):"ACCEPT"===r.type&&e(null,!0)},function(t){return t.tx===r},2)})},h.prototype.stopRinging=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=m.stopRinging(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.accept=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=m.accept(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.reject=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=m.reject(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.unpair=function(t,e){if("function"!==typeof e)throw d.CB_NOT_FUNC;if(!l(t))return e(d.NOT_TRUTHY_STRING("peer"));var n=this,r=Math.random(),i=m.accept(n._user,t,r);n._metastream.write(i,function(t){if(t)return e(t);n.emit("io",i),n._metastream_valve.subscribe(function(t){return e(t.ok?null:d.RES_NOT_OK)},function(t){return t.tx===r},1)})},h.prototype.__defineGetter__("user",function(){return this._user}),t.exports=h},73:function(t,e){},75:function(t,e){},86:function(t,e){}},[[57,2,1]]]);
//# sourceMappingURL=main.9aa06b46.chunk.js.map