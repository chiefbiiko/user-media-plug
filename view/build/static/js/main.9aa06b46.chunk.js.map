{"version":3,"sources":["../../clientele/lib/is.js","../../clientele/lib/outbound.js","actions/index.js","reducers/index.js","store/index.js","components/SinglePage.js","components/Gate.js","utils/index.js","components/Peer.js","components/Peers.js","components/Profile.js","App.js","registerServiceWorker.js","index.js","../../clientele/promised/index.js","../../clientele/index.js"],"names":["isTruthyString","x","module","exports","isStringArray","Array","isArray","every","outbound","whoami","user","tx","type","unix_ts_ms","Date","now","register","password","login","logout","addPeers","peers","deletePeers","getPeers","getUser","status","_status","call","peer","accept","reject","unpair","info","JSON","stringify","avatar","_avatar","stopRinging","craftCrashAction","err","state","err_name","name","err_message","message","err_stack","stack","err_fileName","fileName","err_lineNumber","lineNumber","err_columnNumber","columnNumber","craftUserAction","craftLoginAction","craftLogoutAction","craftTogglePasswordVisibilityAction","createCrashAction","_ref","Object","asyncToGenerator","regenerator_default","a","mark","_callee","dispatch","getState","crash_action","conf","wrap","_context","prev","next","method","body","fetch","t0","stop","this","_x","_x2","apply","arguments","createRegisterAction","_ref3","_callee2","_ref2","client","_context2","setUser","abrupt","alert","t1","createLoginAction","_x3","_x4","_x5","craftResetAction","_ref5","_callee3","_ref4","hydr_user","_context3","sent","craftUserAvatarAction","craftUserStatusAction","t2","t3","t4","craftGotPeersAction","t5","t6","t7","_x6","_x7","_x8","createLogoutAction","_ref7","_callee4","_ref6","_context4","_x9","_x10","_x11","craftOutboundCallAction","craftOutboundAcceptAction","craftOutboundRejectAction","craftOutboundUnpairAction","craftOutboundStopRingingAction","createOutboundCallAction","_ref9","_callee5","_ref8","_context5","concat","_x12","_x13","_x14","createOutboundAcceptAction","_ref11","_callee6","_ref10","_context6","_x15","_x16","_x17","createOutboundRejectAction","_ref13","_callee7","_ref12","_context7","_x18","_x19","_x20","createOutboundUnpairAction","_ref15","_callee8","_ref14","_context8","_x21","_x22","_x23","createOutboundStopRingingAction","_ref17","_callee9","_ref16","_context9","_x24","_x25","_x26","createSyncPeersAction","peer_names","_ref19","_callee10","_ref18","old_names","del_names","add_names","_context10","keys","filter","oldie","includes","nubie","length","_x27","_x28","_x29","createUserStatusAction","_ref21","_callee11","_ref20","_context11","_x30","_x31","_x32","createUserAvatarAction","_ref23","_callee12","_ref22","_context12","_x33","_x34","_x35","appReducer","combineReducers","io_log","undefined","action","toConsumableArray","msg","crashed","logged_in","password_visible","objectSpread","defineProperty","outbound_ringing","inbound_ringing","calling","online","video","rootReducer","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","clientele","store","createStore","applyMiddleware","thunk","withExtraArgument","on","page_style","textAlign","SinglePage","props","crashApp","react_default","createElement","style","components_Gate","components_Profile","components_Peers","lib","autoClose","Component","connect","gate_style","Gate","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","React","createRef","pass","generic","bind","assertThisInitialized","current","focus","e","preventDefault","_len","xyz","_key","areTruthyStrings","value","s","split","map","c","String","fromCharCode","charCodeAt","join","toast","error","onClick","placeholder","ref","togglePasswordVisibility","PeerHeader","AcceptRejectButtons","CallOrHangUpButton","PeerButtons","Peer_AcceptRejectButtons","Peer_CallOrHangUpButton","peer_style","Peer","Peer_PeerHeader","Peer_PeerButtons","peers_style","entries","slicedToArray","k","v","syncPeers","react_tagsinput_default","onChange","inputProps","key","profile_style","mute","stopPropagation","e2InnerText","target","innerText","setAvatar","dispatchUserAvatar","file_reader","FileReader","onerror","_","onload","result","readAsDataURL","dataTransfer","files","setStatus","src","alt","onDrop","onDragOver","onDragEnter","contentEditable","onBlur","App","es","components_SinglePage","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","ReactDOM","render","ReduxApp","document","getElementById","URL","process","origin","addEventListener","response","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","inherits","__webpack_require__","Clientele","PromisedClientele","url","prototype","Promise","resolve","_this2","_this3","_this4","_this5","_this6","_this7","_this8","_this9","_this10","_this11","_this12","_this13","_this14","_this15","EventEmitter","websocket","jsonStream","createReadableValve","getMedia","createRecorder","pump","_require3","ERR","CB_NOT_FUNC","TypeError","RES_NOT_OK","Error","NOT_TRUTHY_STRING","NOT_STRING_ARRAY","_user","test","replace","_meta_url","_media_url","_metastream","emit","_metastream_valve","subscribe","_makeVideoStream","MIME","MIME_CODEC","self","mediastream","write","mediasource","MediaSource","createObjectURL","onsourceopen","mediasource_buf","addSourceBuffer","chunk","appendBuffer","once","play","audio","media","interval","mimeType","cb","Math","random","res","ok","listener","unsubscribe","__defineGetter__"],"mappings":"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","file":"static/js/main.9aa06b46.chunk.js","sourcesContent":["var isTruthyString = function isTruthyString(x) {\n  return x && typeof x === 'string';\n};\n\nvar isStringArray = function isStringArray(x) {\n  return Array.isArray(x) && x.every(isTruthyString);\n};\n\nmodule.exports = {\n  isTruthyString: isTruthyString,\n  isStringArray: isStringArray\n};","var outbound = {\n  whoami: function whoami(user, tx) {\n    return {\n      type: 'WHOAMI',\n      user: user,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  register: function register(user, password, tx) {\n    return {\n      type: 'REGISTER',\n      user: user,\n      password: password,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  login: function login(user, password, tx) {\n    return {\n      type: 'LOGIN',\n      user: user,\n      password: password,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  logout: function logout(user, tx) {\n    return {\n      type: 'LOGOUT',\n      user: user,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  addPeers: function addPeers(user, peers, tx) {\n    return {\n      type: 'ADD_PEERS',\n      user: user,\n      peers: peers,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  deletePeers: function deletePeers(user, peers, tx) {\n    return {\n      type: 'DEL_PEERS',\n      user: user,\n      peers: peers,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  getPeers: function getPeers(user, tx) {\n    return {\n      type: 'GET_PEERS',\n      user: user,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  getUser: function getUser(user, tx) {\n    return {\n      type: 'GET_USER',\n      user: user,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  status: function status(user, _status, tx) {\n    return {\n      type: 'STATUS',\n      user: user,\n      status: _status,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  call: function call(user, peer, tx) {\n    return {\n      type: 'CALL',\n      user: user,\n      peer: peer,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  accept: function accept(user, peer, tx) {\n    return {\n      type: 'ACCEPT',\n      user: user,\n      peer: peer,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  reject: function reject(user, peer, tx) {\n    return {\n      type: 'REJECT',\n      user: user,\n      peer: peer,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  unpair: function unpair(user, peer, tx) {\n    return {\n      type: 'UNPAIR',\n      user: user,\n      peer: peer,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  info: function info(user, peer) {\n    return JSON.stringify({\n      user: user,\n      peer: peer,\n      unix_ts_ms: Date.now()\n    });\n  },\n  avatar: function avatar(user, _avatar, tx) {\n    return {\n      type: 'AVATAR',\n      user: user,\n      avatar: _avatar,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  },\n  stopRinging: function stopRinging(user, peer, tx) {\n    return {\n      type: 'STOP_RINGING',\n      user: user,\n      peer: peer,\n      tx: tx,\n      unix_ts_ms: Date.now()\n    };\n  }\n};\nmodule.exports = outbound;","// TODO: swap all alerts with toasts\r\n\r\nexport function craftIOAction (msg) {\r\n  return {\r\n    type: 'IO',\r\n    unix_ts_ms: Date.now(),\r\n    msg\r\n  }\r\n}\r\n\r\nconst craftCrashAction = (err, state) => ({\r\n  type: 'FRONTEND_CRASH',\r\n  unix_ts_ms: Date.now(),\r\n  err_name: err.name,\r\n  err_message: err.message,\r\n  err_stack: err.stack,\r\n  err_fileName: err.fileName,\r\n  err_lineNumber: err.lineNumber,\r\n  err_columnNumber: err.columnNumber,\r\n  state\r\n})\r\n\r\nconst craftUserAction = user => ({\r\n  type: 'USER',\r\n  unix_ts_ms: Date.now(),\r\n  user\r\n})\r\n\r\nconst craftLoginAction = () => ({\r\n  type: 'LOGIN',\r\n  unix_ts_ms: Date.now()\r\n})\r\n\r\nconst craftLogoutAction = () => ({\r\n  type: 'LOGOUT',\r\n  unix_ts_ms: Date.now()\r\n})\r\n\r\nexport function craftTogglePasswordVisibilityAction () {\r\n  return {\r\n    type: 'TOGGLE_PASSWORD_VISIBILITY',\r\n    unix_ts_ms: Date.now()\r\n  }\r\n}\r\n\r\nexport function createCrashAction (err) {\r\n  return async (dispatch, getState) => {\r\n    const crash_action = craftCrashAction(err, getState())\r\n    dispatch(crash_action)\r\n    const conf = { method: 'post', body: JSON.stringify(crash_action) }\r\n    try { await fetch('http://localhost:10000/crash', conf) } catch (_) {}\r\n  }\r\n}\r\n\r\nexport function createRegisterAction (user, password) {\r\n  return async (dispatch, getState, { client }) => {\r\n    dispatch(craftUserAction(user))\r\n    client.setUser(user)\r\n    try { await client.whoami() }\r\n    catch (_) { return alert('identification failed') }\r\n    try { await client.register(password) }\r\n    catch (_) { return alert('registration failed') }\r\n    dispatch(createLoginAction(user, password))\r\n  }\r\n}\r\n\r\nconst craftResetAction = () => ({\r\n  type: 'RESET',\r\n  unix_ts_ms: Date.now()\r\n})\r\n\r\nexport function createLoginAction (user, password) {\r\n  return async (dispatch, getState, { client }) => {\r\n    if (user !== getState().user) dispatch(craftUserAction(user))\r\n    if (user !== client.user) client.setUser(user)\r\n    try { await client.whoami() }\r\n    catch (_) { return alert('identification failed') }\r\n    try { await client.login(password) }\r\n    catch (_) { return alert('login failed') }\r\n    try {\r\n      const hydr_user = await client.getUser()\r\n      dispatch(craftUserAvatarAction(hydr_user.avatar))\r\n      dispatch(craftUserStatusAction(hydr_user.status))\r\n    }\r\n    catch (_) { return alert('fetching user data failed') }\r\n    try { dispatch(craftGotPeersAction(await client.getPeers())) }\r\n    catch (_) { return alert('fetching peers failed') }\r\n    dispatch(craftLoginAction())\r\n  }\r\n}\r\n\r\nexport function createLogoutAction () {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.logout() }\r\n    catch (_) { return alert('logout failed') }\r\n    dispatch(craftLogoutAction())\r\n    dispatch(craftResetAction())\r\n  }\r\n}\r\n\r\nconst craftOutboundCallAction = peer => ({\r\n  type: 'OUTBOUND_CALL',\r\n  unix_ts_ms: Date.now(),\r\n  peer\r\n})\r\n\r\nconst craftOutboundAcceptAction = peer => ({\r\n  type: 'OUTBOUND_ACCEPT',\r\n  unix_ts_ms: Date.now(),\r\n  peer\r\n})\r\n\r\nconst craftOutboundRejectAction = peer => ({\r\n  type: 'OUTBOUND_REJECT',\r\n  unix_ts_ms: Date.now(),\r\n  peer\r\n})\r\n\r\nconst craftOutboundUnpairAction = peer => ({\r\n  type: 'OUTBOUND_UNPAIR',\r\n  unix_ts_ms: Date.now(),\r\n  peer\r\n})\r\n\r\nconst craftOutboundStopRingingAction = peer => ({\r\n  type: 'OUTBOUND_STOP_RINGING',\r\n  unix_ts_ms: Date.now(),\r\n  peer\r\n})\r\n\r\nexport function createOutboundCallAction (peer) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.call(peer) }\r\n    catch (_) { return alert(`calling ${peer} failed`) }\r\n    dispatch(craftOutboundCallAction(peer))\r\n  }\r\n}\r\n\r\nexport function createOutboundAcceptAction (peer) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.accept(peer) }\r\n    catch (_) { return alert(`accepting ${peer} failed`) }\r\n    dispatch(craftOutboundAcceptAction(peer))\r\n  }\r\n}\r\n\r\nexport function createOutboundRejectAction (peer) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.reject(peer) }\r\n    catch (_) { return alert(`rejecting ${peer} failed`) }\r\n    dispatch(craftOutboundRejectAction(peer))\r\n  }\r\n}\r\n\r\nexport function createOutboundUnpairAction (peer) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.unpair(peer) }\r\n    catch (_) { return alert(`unpairing ${peer} failed`) }\r\n    // NOTE: check how unpairin performs in da real world: UI\r\n    dispatch(craftOutboundUnpairAction(peer))\r\n  }\r\n}\r\n\r\nexport function createOutboundStopRingingAction (peer) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.stopRinging(peer) }\r\n    catch (_) { return alert(`stopRinging ${peer} failed`) }\r\n    dispatch(craftOutboundStopRingingAction(peer))\r\n  }\r\n}\r\n\r\nexport function craftInboundCallAction (msg) {\r\n  return {\r\n    type: 'INBOUND_CALL',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftInboundAcceptAction (msg) {\r\n  return {\r\n    type: 'INBOUND_ACCEPT',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftInboundStopRingingAction (msg) {\r\n  return {\r\n    type: 'INBOUND_STOP_RINGING',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftInboundRejectAction (msg) {\r\n  return {\r\n    type: 'INBOUND_REJECT',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftInboundUnpairAction (msg) {\r\n  return {\r\n    type: 'INBOUND_UNPAIR',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftPeerStatusAction (msg) {\r\n  return {\r\n    type: 'PEER_STATUS',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user,\r\n    status: msg.status\r\n  }\r\n}\r\n\r\nexport function craftPeerAvatarAction (msg) {\r\n  return {\r\n    type: 'PEER_AVATAR',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user,\r\n    avatar: msg.avatar\r\n  }\r\n}\r\n\r\nexport function craftPeerOnlineAction (msg) {\r\n  return {\r\n    type: 'PEER_ONLINE',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftPeerOfflineAction (msg) {\r\n  return {\r\n    type: 'PEER_OFFLINE',\r\n    unix_ts_ms: msg.unix_ts_ms,\r\n    peer: msg.user\r\n  }\r\n}\r\n\r\nexport function craftPeerVideoAction (video, peer) {\r\n  return {\r\n    type: 'PEER_VIDEO',\r\n    unix_ts_ms: Date.now(),\r\n    peer,\r\n    video\r\n  }\r\n}\r\n\r\nconst craftGotPeersAction = peers => ({\r\n  type: 'GOT_PEERS',\r\n  unix_ts_ms: Date.now(),\r\n  peers\r\n})\r\n\r\nexport function createSyncPeersAction (peer_names) {\r\n  return async (dispatch, getState, { client }) => {\r\n    const old_names = Object.keys(getState().peers)\r\n    const del_names = old_names.filter(oldie => !peer_names.includes(oldie))\r\n    const add_names = peer_names.filter(nubie => !old_names.includes(nubie))\r\n    try {\r\n      if (del_names.length) await client.deletePeers(del_names)\r\n      if (add_names.length) await client.addPeers(add_names)\r\n      if (del_names.length || add_names.length)\r\n        dispatch(craftGotPeersAction(await client.getPeers()))\r\n    }\r\n    catch (_) { return alert('syncing peers failed') }\r\n  }\r\n}\r\n\r\nconst craftUserStatusAction = status => ({\r\n  type: 'USER_STATUS',\r\n  unix_ts_ms: Date.now(),\r\n  status\r\n})\r\n\r\nconst craftUserAvatarAction = avatar => ({\r\n  type: 'USER_AVATAR',\r\n  unix_ts_ms: Date.now(),\r\n  avatar\r\n})\r\n\r\nexport function createUserStatusAction (status) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.status(status) }\r\n    catch (_) { return alert('setting status failed') }\r\n    dispatch(craftUserStatusAction(status))\r\n  }\r\n}\r\n\r\nexport function createUserAvatarAction (avatar) {\r\n  return async (dispatch, getState, { client }) => {\r\n    try { await client.avatar(avatar) }\r\n    catch (_) { return alert('setting avatar failed') }\r\n    dispatch(craftUserAvatarAction(avatar))\r\n  }\r\n}\r\n","import { combineReducers } from 'redux'\r\n\r\nconst ioReducer = (state = [], action) => {\r\n  switch (action.type) {\r\n    case 'IO': return [ ...state, action.msg ]\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst crashReducer = (state = false, action) => {\r\n  switch (action.type) {\r\n    case 'FRONTEND_CRASH': return true\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst userReducer = (state = '', action) => {\r\n  switch (action.type) {\r\n    case 'USER': return action.user\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst loginLogoutReducer = (state = false, action) => {\r\n  switch (action.type) {\r\n    case 'LOGIN': return true\r\n    case 'LOGOUT': return false\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst passwordVisibilityReducer = (state = false, action) => {\r\n  switch (action.type) {\r\n    case 'TOGGLE_PASSWORD_VISIBILITY': return !state\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst peersReducer = (state = {}, action) => {\r\n  switch (action.type) {\r\n    case 'OUTBOUND_CALL': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        outbound_ringing: true\r\n      }\r\n    }\r\n    case 'INBOUND_CALL': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        inbound_ringing: true\r\n      }\r\n    }\r\n    case 'OUTBOUND_STOP_RINGING': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        outbound_ringing: false\r\n      }\r\n    }\r\n    case 'INBOUND_STOP_RINGING': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        inbound_ringing: false\r\n      }\r\n    }\r\n    case 'OUTBOUND_ACCEPT': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        inbound_ringing: false,\r\n        calling: true\r\n      }\r\n    }\r\n    case 'INBOUND_ACCEPT': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        outbound_ringing: false,\r\n        calling: true\r\n      }\r\n    }\r\n    case 'OUTBOUND_REJECT': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        inbound_ringing: false\r\n      }\r\n    }\r\n    case 'INBOUND_REJECT': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        outbound_ringing: false\r\n      }\r\n    }\r\n    case 'OUTBOUND_UNPAIR':\r\n    case 'INBOUND_UNPAIR': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        calling: false\r\n      }\r\n    }\r\n    case 'PEER_STATUS': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        status: action.status\r\n      }\r\n    }\r\n    case 'PEER_AVATAR': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        avatar: action.avatar\r\n      }\r\n    }\r\n    case 'PEER_ONLINE': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        online: true\r\n      }\r\n    }\r\n    case 'PEER_OFFLINE': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        online: false\r\n      }\r\n    }\r\n    case 'PEER_VIDEO': return {\r\n      ...state,\r\n      [action.peer]: {\r\n        ...state[action.peer],\r\n        video: action.video\r\n      }\r\n    }\r\n    case 'GOT_PEERS': return { ...action.peers }\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst statusReducer = (state = 'noop', action) => {\r\n  switch (action.type) {\r\n    case 'USER_STATUS': return action.status\r\n    default: return state\r\n  }\r\n}\r\n\r\n// TODO: choose some default avatar!\r\nconst avatarReducer = (state = '...', action) => {\r\n  switch (action.type) {\r\n    case 'USER_AVATAR': return action.avatar\r\n    default: return state\r\n  }\r\n}\r\n\r\nconst appReducer = combineReducers({\r\n  io_log: ioReducer,\r\n  crashed: crashReducer,\r\n  user: userReducer,\r\n  logged_in: loginLogoutReducer,\r\n  password_visible: passwordVisibilityReducer,\r\n  peers: peersReducer,\r\n  status: statusReducer,\r\n  avatar: avatarReducer\r\n})\r\n\r\nconst rootReducer = (state, action) => {\r\n  if (action.type === 'RESET') state = undefined\r\n  return appReducer(state, action)\r\n}\r\n\r\nexport default rootReducer\r\n","import { applyMiddleware, compose, createStore } from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport clientele from 'clientele/promised'\r\nimport {\r\n  craftInboundCallAction,\r\n  craftInboundStopRingingAction,\r\n  craftInboundAcceptAction,\r\n  craftInboundRejectAction,\r\n  craftInboundUnpairAction,\r\n  craftPeerStatusAction,\r\n  craftPeerAvatarAction,\r\n  craftPeerOnlineAction,\r\n  craftPeerOfflineAction,\r\n  craftPeerVideoAction\r\n} from './../actions'\r\nimport rootReducer from './../reducers'\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n\r\nconst client = clientele('ws://localhost:10000')\r\n\r\nconst store = createStore(\r\n  rootReducer,\r\n  composeEnhancers(applyMiddleware(thunk.withExtraArgument({ client })))\r\n)\r\n\r\nclient.on('call', compose(store.dispatch, craftInboundCallAction))\r\nclient.on('stop-ringing', compose(store.dispatch, craftInboundStopRingingAction))\r\nclient.on('accept', compose(store.dispatch, craftInboundAcceptAction))\r\nclient.on('reject', compose(store.dispatch, craftInboundRejectAction))\r\nclient.on('unpair', compose(store.dispatch, craftInboundUnpairAction))\r\nclient.on('status', compose(store.dispatch, craftPeerStatusAction))\r\nclient.on('avatar', compose(store.dispatch, craftPeerAvatarAction))\r\nclient.on('online', compose(store.dispatch, craftPeerOnlineAction))\r\nclient.on('offline', compose(store.dispatch, craftPeerOfflineAction))\r\nclient.on('video', compose(store.dispatch, craftPeerVideoAction))\r\n\r\nexport default store\r\n","import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { compose } from 'redux'\r\nimport { ToastContainer } from 'react-toastify'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\nimport { createCrashAction } from './../actions'\r\nimport { Gate, Peers, Profile } from '.'\r\n\r\nconst page_style = { textAlign: 'center' }\r\n\r\nclass SinglePage extends Component {\r\n  componentDidCatch (err) {\r\n    this.props.crashApp(err)\r\n  }\r\n  render () {\r\n    if (this.props.crashed) return 'Damn, app crashed'\r\n    return (\r\n      <div style={ page_style }>\r\n        <Gate />\r\n        { this.props.logged_in ? <div><Profile /><Peers /></div> : null }\r\n        <ToastContainer autoClose={ 2000 } />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  crashed: state.crashed,\r\n  logged_in: state.logged_in\r\n})\r\n\r\nconst mapDispatchToProps = dispatch =>\r\n  ({ crashApp: compose(dispatch, createCrashAction) })\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SinglePage)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { compose } from 'redux'\r\nimport { toast } from 'react-toastify'\r\nimport { areTruthyStrings, blur } from './../utils'\r\nimport {\r\n  craftTogglePasswordVisibilityAction,\r\n  createRegisterAction,\r\n  createLoginAction,\r\n  createLogoutAction\r\n} from './../actions'\r\n\r\nconst gate_style = {}\r\n\r\nclass Gate extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.name = React.createRef()\r\n    this.pass = React.createRef()\r\n    this.register = this.generic.bind(this, 'register')\r\n    this.login = this.generic.bind(this, 'login')\r\n    this.logout = this.generic.bind(this, 'logout')\r\n  }\r\n  componentDidMount () {\r\n    this.name.current.focus()\r\n  }\r\n  generic (method, e) {\r\n    e.preventDefault()\r\n    if (method === 'logout') return this.props[method]()\r\n    if (!areTruthyStrings(this.name.current.value, this.pass.current.value))\r\n      return toast.error('invalid name or password')\r\n    this.props[method](this.name.current.value, blur(this.pass.current.value))\r\n  }\r\n  render () {\r\n    return (\r\n     <div style={ gate_style }>\r\n       {\r\n         this.props.logged_in\r\n           ? <button onClick={ this.logout }>Logout</button>\r\n           : <div>\r\n               <input placeholder='name' ref={ this.name }/>\r\n               <input type={ this.props.password_visible ? 'text' : 'password' }\r\n                 placeholder='password' ref={ this.pass }/>\r\n               <button onClick={ this.register }>Register</button>\r\n               <button onClick={ this.login }>Login</button>\r\n               <button onClick={ this.props.togglePasswordVisibility }>\r\n                 { this.props.password_visible ? 'Hide' : 'Show' } password\r\n               </button>\r\n             </div>\r\n       }\r\n     </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  logged_in: state.logged_in,\r\n  password_visible: state.password_visible\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  register: compose(dispatch, createRegisterAction),\r\n  login: compose(dispatch, createLoginAction),\r\n  logout: compose(dispatch, createLogoutAction),\r\n  togglePasswordVisibility: compose(dispatch, craftTogglePasswordVisibilityAction)\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Gate)\r\n","export function areTruthyStrings (...xyz) {\r\n  return xyz.every(x => typeof x === 'string' && x.length)\r\n}\r\n\r\nexport function blur (s) {\r\n  return s\r\n    .split('')\r\n    .map(c => String.fromCharCode(c.charCodeAt(0) ^ 19))\r\n    .join('')\r\n}\r\n\r\nexport function isTruthyString (x) {\r\n  return x && typeof x === 'string'\r\n}\r\n\r\nexport function isLengthyStringArray (x) {\r\n  return Array.isArray(x) && x.length && x.every(isTruthyString)\r\n}\r\n\r\nexport function noop () {}\r\n","import React from 'react'\r\n\r\nconst PeerHeader = props => (\r\n  <div>\r\n    <strong>{ props.name }</strong>&nbsp;\r\n    <span>{ props.online ? 'ONLINE' : 'OFFLINE' }</span>&nbsp;\r\n    <em>{ props.status }</em>\r\n  </div>\r\n)\r\n\r\nconst AcceptRejectButtons = props => (\r\n  <div>\r\n    <button onClick={ props.accept }>Accept</button>\r\n    <button onClick={ props.reject }>Reject</button>\r\n  </div>\r\n)\r\n\r\nconst CallOrHangUpButton = props => {\r\n  if (props.calling)\r\n    return <button onClick={ props.unpair }>Hang up</button>\r\n  if (!props.calling && props.outbound_ringing)\r\n    return <button onClick={ props.stopRinging }>Hang up</button>\r\n  if (!props.calling && !props.outbound_ringing)\r\n    return <button onClick={ props.call }>Call</button>\r\n}\r\n\r\nconst PeerButtons = props => {\r\n  if (!props.online) return null // TODO: render some fun placeholder\r\n  if (props.inbound_ringing) return <AcceptRejectButtons { ...props } />\r\n  if (!props.inbound_ringing) return <CallOrHangUpButton { ...props } />\r\n}\r\n\r\nconst peer_style = {}\r\n\r\nexport default function Peer (props) {\r\n  return (\r\n    <div style={ peer_style }>\r\n      <PeerHeader { ...props } />\r\n      <PeerButtons { ...props } />\r\n      { props.video }\r\n    </div>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { compose } from 'redux'\r\nimport TagsInput from 'react-tagsinput'\r\nimport 'react-tagsinput/react-tagsinput.css'\r\nimport Peer from './Peer.js'\r\nimport {\r\n  createOutboundCallAction,\r\n  createOutboundStopRingingAction,\r\n  createOutboundAcceptAction,\r\n  createOutboundRejectAction,\r\n  createOutboundUnpairAction,\r\n  createSyncPeersAction\r\n} from './../actions'\r\n\r\nconst peers_style = {}\r\n\r\nconst Peers = ({\r\n  call,\r\n  stopRinging,\r\n  accept,\r\n  reject,\r\n  unpair,\r\n  syncPeers,\r\n  peer_names,\r\n  peers\r\n}) => (\r\n  <div style={ peers_style }>\r\n    <TagsInput\r\n      value={ peer_names }\r\n      onChange={ syncPeers }\r\n      inputProps={ { placeholder: 'yo friend list' } }>\r\n    </TagsInput>\r\n    {\r\n      peers.map(peer => (\r\n        <Peer\r\n          key={ peer.name }\r\n          name={ peer.name }\r\n          online={ peer.online }\r\n          status={ peer.status }\r\n          calling={ peer.calling }\r\n          inbound_ringing={ peer.inbound_ringing }\r\n          outbound_ringing={ peer.outbound_ringing }\r\n          video={ peer.video }\r\n          call={ call }\r\n          stopRinging={ stopRinging }\r\n          accept={ accept }\r\n          reject={ reject }\r\n          unpair={ unpair }>\r\n        </Peer>\r\n      ))\r\n    }\r\n  </div>\r\n)\r\n\r\nconst mapStateToProps = state => ({\r\n  peers: Object.entries(state.peers).map(([ k, v ]) => ({ ...v, name: k })),\r\n  peer_names: Object.keys(state.peers)\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  call: compose(dispatch, createOutboundCallAction),\r\n  stopRinging: compose(dispatch, createOutboundStopRingingAction),\r\n  accept: compose(dispatch, createOutboundAcceptAction),\r\n  reject: compose(dispatch, createOutboundRejectAction),\r\n  unpair: compose(dispatch, createOutboundUnpairAction),\r\n  syncPeers: compose(dispatch, createSyncPeersAction)\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Peers)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { compose } from 'redux'\r\nimport { toast } from 'react-toastify'\r\nimport { createUserAvatarAction, createUserStatusAction } from './../actions'\r\n\r\nconst profile_style = {}\r\n\r\nconst Profile = ({ avatar, status, setAvatar, setStatus }) => (\r\n  <div style={ profile_style }>\r\n    <img src={ avatar } alt='avatar'\r\n      onDrop={ setAvatar }\r\n      onDragOver={ mute }\r\n      onDragEnter={ mute } />\r\n    <div contentEditable onBlur={ setStatus }>{ status }</div>\r\n  </div>\r\n)\r\n\r\nconst mute = e => {\r\n  e.stopPropagation()\r\n  e.preventDefault()\r\n}\r\n\r\nconst makeAvatar = (dispatchUserAvatar, e) => {\r\n  mute(e)\r\n  const file_reader = new FileReader()\r\n  file_reader.onerror = _ => toast.error('setting avatar failed')\r\n  file_reader.onload = () => dispatchUserAvatar(file_reader.result)\r\n  file_reader.readAsDataURL(e.dataTransfer.files[0])\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  avatar: state.avatar,\r\n  status: state.status\r\n})\r\n\r\nconst e2InnerText = e => e.target.innerText\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  setAvatar: makeAvatar.bind(null, compose(dispatch, createUserAvatarAction)),\r\n  setStatus: compose(dispatch, createUserStatusAction, e2InnerText)\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Profile)\r\n","import React from 'react'\r\nimport { Provider } from 'react-redux'\r\nimport store from './store'\r\nimport { SinglePage } from './components'\r\n\r\nconst App = <Provider store={ store }><SinglePage /></Provider>\r\n\r\nexport default App\r\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import ReactDOM from 'react-dom'\r\nimport ReduxApp from './App.js'\r\nimport registerServiceWorker from './registerServiceWorker.js'\r\nimport './index.css'\r\n\r\nReactDOM.render(ReduxApp, document.getElementById('root'))\r\n\r\nregisterServiceWorker()\r\n","var _require = require('util'),\n    inherits = _require.inherits;\n\nvar Clientele = require('./../index.js');\n\nfunction PromisedClientele(url, user) {\n  if (!(this instanceof PromisedClientele)) return new PromisedClientele(url, user);\n  Clientele.call(this, url, user);\n}\n\ninherits(PromisedClientele, Clientele);\n\nPromisedClientele.prototype.whoami = function whoami() {\n  var _this = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.whoami.call(_this, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.register = function register(password) {\n  var _this2 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.register.call(_this2, password, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.login = function login(password) {\n  var _this3 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.login.call(_this3, password, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.logout = function logout() {\n  var _this4 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.logout.call(_this4, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.addPeers = function addPeers(peers) {\n  var _this5 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.addPeers.call(_this5, peers, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.deletePeers = function deletePeers(peers) {\n  var _this6 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.deletePeers.call(_this6, peers, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.getPeers = function getPeers() {\n  var _this7 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.getPeers.call(_this7, function (err, peers) {\n      return err ? reject(err) : resolve(peers);\n    });\n  });\n};\n\nPromisedClientele.prototype.getUser = function getUser() {\n  var _this8 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.getUser.call(_this8, function (err, user) {\n      return err ? reject(err) : resolve(user);\n    });\n  });\n};\n\nPromisedClientele.prototype.status = function status(status) {\n  var _this9 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.status.call(_this9, status, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.avatar = function avatar(avatar) {\n  var _this10 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.avatar.call(_this10, avatar, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.call = function call(peer) {\n  var _this11 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.call.call(_this11, peer, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.stopRinging = function stopRinging(peer) {\n  var _this12 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.stopRinging.call(_this12, peer, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.accept = function accept(peer) {\n  var _this13 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.accept.call(_this13, peer, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.reject = function reject(peer) {\n  var _this14 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.reject.call(_this14, peer, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nPromisedClientele.prototype.unpair = function unpair(peer) {\n  var _this15 = this;\n\n  return new Promise(function (resolve, reject) {\n    Clientele.prototype.unpair.call(_this15, peer, function (err) {\n      return err ? reject(err) : resolve();\n    });\n  });\n};\n\nmodule.exports = PromisedClientele;","var _require = require('events'),\n    EventEmitter = _require.EventEmitter;\n\nvar _require2 = require('util'),\n    inherits = _require2.inherits;\n\nvar websocket = require('websocket-stream');\n\nvar jsonStream = require('duplex-json-stream');\n\nvar createReadableValve = require('readable-valve');\n\nvar getMedia = require('getusermedia');\n\nvar createRecorder = require('media-recorder-stream');\n\nvar pump = require('pump');\n\nvar _require3 = require('./lib/is.js'),\n    isTruthyString = _require3.isTruthyString,\n    isStringArray = _require3.isStringArray;\n\nvar outbound = require('./lib/outbound.js');\n\nvar debug = require('debug')('clientele');\n\nvar ERR = {\n  CB_NOT_FUNC: TypeError('cb is not a function'),\n  RES_NOT_OK: Error('response status not ok'),\n  NOT_TRUTHY_STRING: function NOT_TRUTHY_STRING(x) {\n    return TypeError(\"\".concat(x, \" is not a truthy string\"));\n  },\n  NOT_STRING_ARRAY: function NOT_STRING_ARRAY(x) {\n    return TypeError(\"\".concat(x, \" is not a string array\"));\n  }\n}; // TODO: rethink browser compatibility check!\n\nfunction Clientele(url, user) {\n  // url can just be 'ws://localhost:10000'\n  if (!(this instanceof Clientele)) return new Clientele(url, user);\n  EventEmitter.call(this); // if (!/firefox/i.test(navigator.userAgent))\n  //   alert(`app probly won't work on ${navigator.userAgent}`)\n  // else if (!MediaSource.isTypeSupported(Clientele.MIME_CODEC) ||\n  //          !MediaRecorder.isTypeSupported(Clientele.MIME))\n  //   throw Error(`unsupported MIME type or codec: ${Clientele.MIME_CODEC}`)\n\n  if (!isTruthyString(url)) throw ERR.NOT_TRUTHY_STRING('url');\n  if (isTruthyString(user)) this._user = user;\n  if (!/(?:\\/meta|\\/media)$/.test(url)) url = \"\".concat(url.replace(/^(.+:\\d+).*$/, '$1'), \"/meta\");\n  this._meta_url = url.replace('media', 'meta');\n  this._media_url = url.replace('meta', 'media');\n  this._metastream = jsonStream(websocket(this._meta_url));\n\n  this._metastream.on('error', this.emit.bind(this, 'error'));\n\n  this._metastream.on('data', this.emit.bind(this, 'io'));\n\n  this._metastream_valve = createReadableValve(this._metastream).subscribe(this._makeVideoStream.bind(this), function (msg) {\n    return msg.type === 'FORCE_CALL';\n  }).subscribe(this.emit.bind(this, 'call'), function (msg) {\n    return msg.type === 'CALL';\n  }).subscribe(this.emit.bind(this, 'stop-ringing'), function (msg) {\n    return msg.type === 'STOP_RINGING';\n  }).subscribe(this.emit.bind(this, 'accept'), function (msg) {\n    return msg.type === 'ACCEPT';\n  }).subscribe(this.emit.bind(this, 'reject'), function (msg) {\n    return msg.type === 'REJECT';\n  }).subscribe(this.emit.bind(this, 'unpair'), function (msg) {\n    return msg.type === 'UNPAIR';\n  }).subscribe(this.emit.bind(this, 'status'), function (msg) {\n    return msg.type === 'STATUS';\n  }).subscribe(this.emit.bind(this, 'avatar'), function (msg) {\n    return msg.type === 'AVATAR';\n  }).subscribe(this.emit.bind(this, 'online'), function (msg) {\n    return msg.type === 'ONLINE';\n  }).subscribe(this.emit.bind(this, 'offline'), function (msg) {\n    return msg.type === 'OFFLINE';\n  });\n}\n\ninherits(Clientele, EventEmitter);\nClientele.MIME = 'video/webm';\nClientele.MIME_CODEC = \"\".concat(Clientele.MIME, \";codecs=vorbis,vp8\");\n\nClientele.prototype.setUser = function setUser(user) {\n  if (!isTruthyString(user)) throw ERR.NOT_TRUTHY_STRING('user');\n  this._user = user;\n};\n\nClientele.prototype._makeVideoStream = function makeVideoStream(msg) {\n  var self = this;\n  var mediastream = websocket(self._media_url);\n  mediastream.write(outbound.info(self._user, msg.peer), function (err) {\n    if (err) return self.emit('error', err); // i\n\n    var video = document.createElement('video');\n    var mediasource = new MediaSource();\n    video.src = URL.createObjectURL(mediasource);\n\n    mediasource.onsourceopen = function () {\n      var mediasource_buf = mediasource.addSourceBuffer(Clientele.MIME_CODEC);\n      mediastream.on('data', function (chunk) {\n        return mediasource_buf.appendBuffer(chunk);\n      });\n      mediastream.once('readable', function () {\n        return video.play();\n      });\n      self.emit('video', video, msg.peer);\n    }; // o\n\n\n    getMedia({\n      audio: true,\n      video: true\n    }, function (err, media) {\n      if (err) return self.emit('error', err);\n      pump(createRecorder(media, {\n        interval: 1000,\n        mimeType: Clientele.MIME\n      }), mediastream, function (err) {\n        video = mediasource = mediasource_buf = null;\n        if (err) self.emit('error', err);\n      });\n    });\n  });\n};\n\nClientele.prototype.whoami = function whoami(cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.whoami(self._user, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.register = function register(password, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(password)) return cb(ERR.NOT_TRUTHY_STRING('password'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.register(self._user, password, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.login = function login(password, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(password)) return cb(ERR.NOT_TRUTHY_STRING('password'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.login(self._user, password, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.logout = function logout(cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.logout(self._user, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.addPeers = function addPeers(peers, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isStringArray(peers)) return cb(ERR.NOT_STRING_ARRAY('peers'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.addPeers(self._user, peers, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.deletePeers = function deletePeers(peers, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isStringArray(peers)) return cb(ERR.NOT_STRING_ARRAY('peers'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.deletePeers(self._user, peers, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.getPeers = function getPeers(cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.getPeers(self._user, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return res.ok ? cb(null, res.peers) : cb(ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.getUser = function getUser(cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.getUser(self._user, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return res.ok ? cb(null, res.user) : cb(ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.status = function status(status, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(status)) return cb(ERR.NOT_TRUTHY_STRING('status'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.status(self._user, status, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.avatar = function avatar(avatar, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(avatar)) return cb(ERR.NOT_TRUTHY_STRING('avatar'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.avatar(self._user, avatar, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.call = function call(peer, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(peer)) return cb(ERR.NOT_TRUTHY_STRING('peer'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.call(self._user, peer, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function listener(res) {\n      if (!res.ok) {\n        self._metastream_valve.unsubscribe(listener);\n\n        return cb(ERR.RES_NOT_OK, false);\n      }\n\n      if (res.type === 'REJECT') cb(null, false);else if (res.type === 'ACCEPT') cb(null, true);\n    }, function (res) {\n      return res.tx === tx;\n    }, 2);\n  });\n};\n\nClientele.prototype.stopRinging = function stopRinging(peer, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(peer)) return cb(ERR.NOT_TRUTHY_STRING('peer'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.stopRinging(self._user, peer, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.accept = function accept(peer, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(peer)) return cb(ERR.NOT_TRUTHY_STRING('peer'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.accept(self._user, peer, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.reject = function reject(peer, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(peer)) return cb(ERR.NOT_TRUTHY_STRING('peer'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.reject(self._user, peer, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.unpair = function unpair(peer, cb) {\n  if (typeof cb !== 'function') throw ERR.CB_NOT_FUNC;\n  if (!isTruthyString(peer)) return cb(ERR.NOT_TRUTHY_STRING('peer'));\n  var self = this;\n  var tx = Math.random();\n  var msg = outbound.accept(self._user, peer, tx);\n\n  self._metastream.write(msg, function (err) {\n    if (err) return cb(err);\n    self.emit('io', msg);\n\n    self._metastream_valve.subscribe(function (res) {\n      return cb(res.ok ? null : ERR.RES_NOT_OK);\n    }, function (res) {\n      return res.tx === tx;\n    }, 1);\n  });\n};\n\nClientele.prototype.__defineGetter__('user', function () {\n  return this._user;\n});\n\nmodule.exports = Clientele;"],"sourceRoot":""}